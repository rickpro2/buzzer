<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Host Panel</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body{font-family:system-ui;background:#111;color:#fff;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0}
.container{max-width:900px;width:95%;background:#1b1b1b;padding:2rem;border-radius:16px}
h1{text-align:center}
.section{margin-top:1.5rem}
.card{background:#222;padding:1rem;border-radius:12px;margin:.5rem 0}
.row{display:flex;justify-content:space-between;align-items:center}
button{border:none;border-radius:999px;padding:.5rem 1.2rem;font-weight:600;cursor:pointer}
.add{background:#00af3f;color:#fff}
.sub{background:#d40000;color:#fff}
</style>
</head>

<body>
<div class="container">
<h1>Host Control Panel</h1>

<button onclick="socket.emit('createRoom')">Create Room</button>
<h2 id="pin"></h2>

<div class="section">
  <button onclick="socket.emit('arm',pin)">Arm</button>
  <button onclick="socket.emit('reset',pin)">Reset</button>
</div>

<div class="section">
  <h2>Scoreboard</h2>
  <div id="scores"></div>
</div>
</div>

<script>
const socket = io();
let pin=null;

socket.on("roomCreated", d=>{
  pin=d.pin;
  document.getElementById("pin").textContent="Room PIN: "+pin;
  socket.emit("joinRoom",{pin});
});

socket.on("scoreUpdate", scores=>{
  const el=document.getElementById("scores");
  el.innerHTML="";
  Object.keys(scores).forEach(k=>{
    el.innerHTML+=`
      <div class="card row">
        <strong>${k}</strong>
        <div>
          <button class="sub" onclick="socket.emit('updateScore',{pin,key:'${k}',delta:-1})">âˆ’</button>
          <span style="margin:0 10px">${scores[k]}</span>
          <button class="add" onclick="socket.emit('updateScore',{pin,key:'${k}',delta:1})">+</button>
        </div>
      </div>`;
  });
});

socket.on("roomExpired",()=>{
  alert("Room expired due to inactivity");
  location.reload();
});
</script>
</body>
</html>
