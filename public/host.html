<!DOCTYPE html>
<html>
<head>
  <title>Host Control Panel</title>
  <link rel="stylesheet" href="style.css" />
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>

  <h1>Host Panel</h1>

  <!-- TEAM SETUP -->
  <h2>Team Setup</h2>
  <input id="teamInput" placeholder="Red, Blue, Green" style="width:80%;padding:10px;">
  <button id="setTeamsBtn">Update Teams</button>

  <hr>

  <!-- PLAYER LIST -->
  <div id="players"></div>

  <hr>

  <!-- CONTROL BUTTONS -->
  <button id="armBtn">ARM BUZZER</button>
  <button id="resetBtn">RESET</button>

  <h2 id="winner"></h2>

<script>
const socket = io();

const playersDiv = document.getElementById("players");
const winnerDiv = document.getElementById("winner");
const teamInput = document.getElementById("teamInput");

document.getElementById("armBtn").onclick = () => socket.emit("arm");
document.getElementById("resetBtn").onclick = () => socket.emit("reset");

document.getElementById("setTeamsBtn").onclick = () => {
  const teams = teamInput.value
    .split(",")
    .map(t => t.trim())
    .filter(t => t.length > 0);

  if (teams.length > 0) socket.emit("setTeams", teams);
};

// Receive teams from server
socket.on("teamList", (teams) => {
  teamInput.value = teams.join(", ");
});

// Receive player list
socket.on("playerList", (players) => {
  let html = "<h2>Players by Team</h2>";

  const grouped = {};
  players.forEach(p => {
    if (!grouped[p.team]) grouped[p.team] = [];
    grouped[p.team].push(p.name);
  });

  for (let team in grouped) {
    html += `<div class="teamBlock"><h3>${team}</h3>`;
    html += grouped[team].map(name => `<div class="player">${name}</div>`).join("");
    html += "</div>";
  }

  playersDiv.innerHTML = html;
});

// Winner announcement
socket.on("winner", (player) => {
  winnerDiv.textContent = `${player.team} â€“ ${player.name} buzzed first!`;
});

// State updates
socket.on("armed", () => {
  winnerDiv.textContent = "Buzzers Armed!";
});

socket.on("reset", () => {
  winnerDiv.textContent = "";
});
</script>

</body>
</html>
