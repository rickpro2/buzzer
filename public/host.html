<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Host Control Panel</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body {
  font-family: system-ui;
  background: #111;
  color: #f5f5f5;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  margin: 0;
}
.container {
  width: 95%;
  max-width: 950px;
  background: #1b1b1b;
  padding: 2rem;
  border-radius: 16px;
}
h1 { text-align: center; }

/* Toggle Switch */
.toggle {
  display: flex;
  align-items: center;
  gap: 1rem;
  justify-content: center;
  margin: 1rem 0;
}
.switch {
  position: relative;
  width: 60px;
  height: 32px;
}
.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}
.slider {
  position: absolute;
  cursor: pointer;
  background: #555;
  border-radius: 999px;
  top: 0; left: 0; right: 0; bottom: 0;
  transition: 0.3s;
}
.slider:before {
  position: absolute;
  content: "";
  height: 24px;
  width: 24px;
  left: 4px;
  bottom: 4px;
  background: white;
  border-radius: 50%;
  transition: 0.3s;
}
input:checked + .slider {
  background: #00af3f;
}
input:checked + .slider:before {
  transform: translateX(28px);
}

/* Buttons */
button {
  border: none;
  border-radius: 999px;
  padding: 0.6rem 1.4rem;
  font-weight: 700;
  cursor: pointer;
}
.green { background:#00af3f;color:#fff }
.gray { background:#444;color:#eee }

.panel {
  background:#222;
  padding:1rem;
  border-radius:14px;
  margin-top:1rem;
}
</style>
</head>

<body>
<div class="container">
<h1>Host Control Panel</h1>

<button id="createRoom" class="green">Create Room</button>
<h2 id="pin"></h2>

<!-- TEAM MODE TOGGLE -->
<div class="toggle">
  <strong>Team Mode</strong>
  <label class="switch">
    <input type="checkbox" id="teamToggle" checked>
    <span class="slider"></span>
  </label>
</div>

<div style="text-align:center;margin-bottom:1rem;color:#aaa;">
  ON = Teams required Â· OFF = Solo play
</div>

<div style="text-align:center;">
  <button class="green" id="armBtn">Arm</button>
  <button class="gray" id="resetBtn">Reset</button>
</div>

<div class="panel">
  <h3>Players Joined</h3>
  <div id="players">None</div>
</div>

<div class="panel">
  <h3>Scoreboard</h3>
  <div id="scores"></div>
</div>
</div>

<script>
const socket = io();
let pin = null;

const teamToggle = document.getElementById("teamToggle");
const playersEl = document.getElementById("players");
const scoresEl = document.getElementById("scores");

document.getElementById("createRoom").onclick = () => socket.emit("createRoom");
document.getElementById("armBtn").onclick = () => socket.emit("arm", pin);
document.getElementById("resetBtn").onclick = () => socket.emit("reset", pin);

teamToggle.onchange = () => {
  socket.emit("toggleTeamMode", {
    pin,
    enabled: teamToggle.checked
  });
};

socket.on("roomCreated", d => {
  pin = d.pin;
  document.getElementById("pin").textContent = "Room PIN: " + pin;
  socket.emit("joinRoom", { pin, name: "HOST", team: "Red" });
});

socket.on("playerList", players => {
  const filtered = players.filter(p => p.name !== "HOST");
  playersEl.innerHTML = filtered.length
    ? filtered.map(p => `${p.name} (${p.team})`).join("<br>")
    : "None";
});

socket.on("scoreUpdate", scores => {
  scoresEl.innerHTML = "";
  Object.keys(scores).forEach(k => {
    scoresEl.innerHTML += `<div>${k}: ${scores[k]}</div>`;
  });
});

socket.on("roomInfo", info => {
  teamToggle.checked = info.teamMode;
});
</script>
</body>
</html>
