<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Buzzer</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body {
  font-family:system-ui,sans-serif;
  background:#111;
  color:#f5f5f5;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  margin:0;
}
.container {
  max-width:500px;
  width:100%;
  padding:2rem;
  background:#1b1b1b;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.6);
}
.status {
  text-align:center;
  padding:.75rem;
  border-radius:999px;
  background:#222;
  margin-bottom:1.5rem;
}
.status.armed { background:#004d17; color:#c7ffd1; }
.status.winner { background:#4d0000; color:#ffd5d5; }

input,select {
  width:100%;
  padding:.75rem;
  background:#222;
  color:#fff;
  border:none;
  border-radius:8px;
  margin-bottom:1rem;
}

#error {
  color:#ff7777;
  text-align:center;
  margin-bottom:1rem;
}

#buzzBtn {
  width:260px;
  height:260px;
  border-radius:50%;
  background:#555;
  color:#ccc;
  font-size:2rem;
  border:none;
  margin:0 auto;
  display:block;
}
#buzzBtn.armed { background:#d40000; color:#fff; }
#buzzBtn.you { background:#009900; color:#fff; }
#buzzBtn.locked { background:#333; color:#777; }
</style>
</head>

<body>
<div class="container">

<div id="joinScreen">
  <div id="error"></div>
  <input id="nameInput" placeholder="Your Name">
  <select id="teamSelect"></select>
  <button id="joinBtn">Join</button>
</div>

<div id="buzzScreen" style="display:none;">
  <div id="status" class="status">Waiting for host…</div>
  <button id="buzzBtn" disabled>BUZZ</button>
</div>

</div>

<script>
const socket = io();
let teamMode=true;
let me=null;

const join=document.getElementById("joinScreen");
const buzz=document.getElementById("buzzScreen");
const buzzBtn=document.getElementById("buzzBtn");
const status=document.getElementById("status");
const teamSelect=document.getElementById("teamSelect");
const errorBox=document.getElementById("error");

socket.on("config", c=>{
  teamMode=c.teamMode;
  teamSelect.style.display=teamMode?"block":"none";
  teamSelect.innerHTML=c.teams.map(t=>`<option>${t}</option>`).join("");
});

document.getElementById("joinBtn").onclick=()=>{
  const name=document.getElementById("nameInput").value.trim();
  const team=teamSelect.value;
  if(!name)return;
  socket.emit("join",{name,team});
};

socket.on("joinError", msg=>{
  errorBox.textContent=msg;
});

socket.on("playerList",()=>{
  join.style.display="none";
  buzz.style.display="block";
});

buzzBtn.onclick=()=>{
  buzzBtn.className="you";
  socket.emit("buzz");
};

socket.on("armed",()=>{
  status.textContent="BUZZ NOW!";
  status.className="status armed";
  buzzBtn.disabled=false;
  buzzBtn.className="armed";
});

socket.on("winner",p=>{
  status.textContent=p.team==="Solo"
    ? `${p.name} buzzed first!`
    : `${p.team} – ${p.name} buzzed first!`;
  status.className="status winner";
  buzzBtn.disabled=true;
  buzzBtn.className=(me&&me.name===p.name)?"you":"locked";
});

socket.on("reset",()=>{
  status.textContent="Waiting for host…";
  status.className="status";
  buzzBtn.disabled=true;
  buzzBtn.className="";
});
</script>
</body>
</html>
