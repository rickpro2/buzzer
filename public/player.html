<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Join Game</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body {
  font-family:system-ui,sans-serif;
  background:#111;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
  margin:0;
}
.container {
  width:400px;
  background:#1b1b1b;
  padding:2rem;
  border-radius:16px;
}
button {
  width:100%;
  padding:1rem;
  border-radius:999px;
  border:none;
  margin-top:1rem;
}
#buzzBtn {
  width:240px;
  height:240px;
  border-radius:50%;
  background:#555;
  font-size:2rem;
}
#buzzBtn.armed { background:#d40000; }
#buzzBtn.you { background:#009900; }
#buzzBtn.locked { background:#333; }
</style>
</head>

<body>
<div class="container">

<div id="joinScreen">
  <input id="pinInput" placeholder="Room PIN">
  <input id="nameInput" placeholder="Your Name">
  <select id="teamSelect"></select>
  <button id="joinBtn">Join Game</button>
</div>

<div id="buzzScreen" style="display:none;">
  <div id="status">Waitingâ€¦</div>
  <button id="buzzBtn" disabled>BUZZ</button>
</div>

</div>

<script>
const socket = io();
let pin = null;
let me = null;

socket.on("config", c => {
  document.getElementById("teamSelect").innerHTML =
    c.teams.map(t=>`<option>${t}</option>`).join("");
});

document.getElementById("joinBtn").onclick = () => {
  pin = document.getElementById("pinInput").value.trim();
  const name = document.getElementById("nameInput").value.trim();
  const team = document.getElementById("teamSelect").value;

  socket.emit("joinRoom", { pin, name, team });
};

socket.on("joinError", msg => alert(msg));

socket.on("playerList", () => {
  document.getElementById("joinScreen").style.display="none";
  document.getElementById("buzzScreen").style.display="block";
});

const buzzBtn = document.getElementById("buzzBtn");

buzzBtn.onclick = () => socket.emit("buzz", pin);

socket.on("armed", () => {
  buzzBtn.disabled=false;
  buzzBtn.className="armed";
});

socket.on("winner", p => {
  buzzBtn.disabled=true;
  buzzBtn.className =
    me && me.name===p.name ? "you":"locked";
});
</script>
</body>
</html>
